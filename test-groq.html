<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Groq API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .test-button:hover {
            background: #5a6fd8;
        }
        .test-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            margin: 10px 0;
        }
        .test-input:focus {
            border-color: #667eea;
            outline: none;
        }
        .result {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }
        .error {
            border-left-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }
        .success {
            border-left-color: #28a745;
            background: #d4edda;
            color: #155724;
        }
        .loading {
            color: #667eea;
            font-style: italic;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }
        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <a href="index.html" class="back-link">‚Üê Back to Portfolio</a>
        
        <h1>ü§ñ Groq API Integration Test</h1>
        <p>This page tests your Groq API integration before deployment.</p>

        <div class="test-section">
            <h3>üîë API Key Test</h3>
            <p>Test if your Groq API key is valid:</p>
            <button class="test-button" onclick="testAPIKey()">Test API Key</button>
            <div id="apiKeyResult"></div>
        </div>

        <div class="test-section">
            <h3>üí¨ Chat Test</h3>
            <p>Test the chat functionality with Groq:</p>
            <input type="text" class="test-input" id="testMessage" placeholder="Type a message to test..." value="Tell me about this portfolio">
            <button class="test-button" onclick="testChat()">Send Test Message</button>
            <div id="chatResult"></div>
        </div>

        <div class="test-section">
            <h3>üåê Current Status</h3>
            <p>Why you're seeing hardcoded messages:</p>
            <div id="currentStatus"></div>
        </div>

        <div class="test-section">
            <h3>üìã Next Steps</h3>
            <ol>
                <li><strong>Test API Key</strong> - Verify your Groq key works</li>
                <li><strong>Test Chat</strong> - Verify the integration works</li>
                <li><strong>Deploy to Vercel</strong> - Make it live</li>
                <li><strong>Enjoy Real AI</strong> - No more hardcoded responses!</li>
            </ol>
        </div>

        <div class="test-section">
            <h3>üîß What We Fixed</h3>
            <p>We've removed the fallback system so your chat will:</p>
            <ul>
                <li>‚úÖ <strong>Only use Groq API</strong> - No more hardcoded responses</li>
                <li>‚úÖ <strong>Show proper errors</strong> - Clear feedback when API fails</li>
                <li>‚úÖ <strong>Work immediately</strong> - Once deployed to Vercel</li>
            </ul>
        </div>
    </div>

    <script>
        // Your Groq API key (for testing only - don't commit this!)
        const GROQ_API_KEY = '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';
        
        // Updated model parameters
        const MODEL_CONFIG = {
            model: 'meta-llama/llama-4-scout-17b-16e-instruct',
            temperature: 1,
            max_tokens: 1024,
            top_p: 1
        };
        
        async function testAPIKey() {
            const resultDiv = document.getElementById('apiKeyResult');
            resultDiv.innerHTML = '<div class="loading">Testing API key...</div>';
            
            try {
                const response = await fetch('https://api.groq.com/openai/v1/models', {
                    headers: {
                        'Authorization': `Bearer ${GROQ_API_KEY}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = `
                        <div class="result success">
                            ‚úÖ <strong>API Key Valid!</strong><br>
                            Available models: ${data.data.length}<br>
                            Your key is working correctly!<br>
                            <strong>Next:</strong> Deploy to Vercel to activate real AI!
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            ‚ùå <strong>API Key Invalid!</strong><br>
                            Status: ${response.status}<br>
                            Please check your API key
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        ‚ùå <strong>Connection Error!</strong><br>
                        ${error.message}<br>
                        Check your internet connection
                    </div>
                `;
            }
        }

        async function testChat() {
            const resultDiv = document.getElementById('chatResult');
            const message = document.getElementById('testMessage').value;
            
            if (!message.trim()) {
                resultDiv.innerHTML = '<div class="result error">Please enter a message to test</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="loading">Sending message to Groq...</div>';
            
            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${GROQ_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: MODEL_CONFIG.model,
                        messages: [
                            {
                                role: 'system',
                                content: 'You are a helpful AI assistant for a developer portfolio. Be concise and helpful.'
                            },
                            {
                                role: 'user',
                                content: message
                            }
                        ],
                        temperature: MODEL_CONFIG.temperature,
                        max_tokens: MODEL_CONFIG.max_tokens,
                        top_p: MODEL_CONFIG.top_p
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    resultDiv.innerHTML = `
                        <div class="result success">
                            ‚úÖ <strong>Chat Working!</strong><br>
                            <strong>Model:</strong> ${MODEL_CONFIG.model}<br>
                            <strong>Your message:</strong> ${message}<br>
                            <strong>AI Response:</strong> ${aiResponse}<br>
                            <strong>Tokens used:</strong> ${data.usage.total_tokens}<br>
                            <br>
                            <strong>üéâ Your Groq API is working perfectly!</strong><br>
                            Now deploy to Vercel to activate it in your portfolio!
                        </div>
                    `;
                } else {
                    const errorData = await response.json();
                    resultDiv.innerHTML = `
                        <div class="result error">
                            ‚ùå <strong>Chat Failed!</strong><br>
                            Status: ${response.status}<br>
                            Error: ${errorData.error?.message || 'Unknown error'}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        ‚ùå <strong>Connection Error!</strong><br>
                        ${error.message}<br>
                        Check your internet connection
                    </div>
                `;
            }
        }

        function updateCurrentStatus() {
            const statusDiv = document.getElementById('currentStatus');
            statusDiv.innerHTML = `
                <div class="result">
                    <strong>Why Hardcoded Messages?</strong><br>
                    ‚úÖ Your portfolio is working correctly<br>
                    ‚úÖ AI chat button is functional<br>
                    ‚ùå Groq API endpoint doesn't exist locally<br>
                    üîß Serverless function needs Vercel deployment<br>
                    <br>
                    <strong>‚úÖ What We Fixed:</strong><br>
                    ‚Ä¢ Removed fallback system - Chat will only use Groq API<br>
                    ‚Ä¢ Clear error messages when API fails<br>
                    ‚Ä¢ No more hardcoded responses<br>
                    <br>
                    <strong>Solution:</strong><br>
                    Deploy to Vercel and add your GROQ_API_KEY environment variable!
                </div>
            `;
        }

        // Initialize page
        updateCurrentStatus();
    </script>
</body>
</html>
